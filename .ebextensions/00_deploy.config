option_settings:
  aws:elasticbeanstalk:environment:proxy:
    ProxyServer: nginx

packages:
  yum:
    nodejs18: []
    gcc-c++: []
    make: []

files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/50_mkdir.sh":
    mode: "000755"
    owner: webapp
    group: webapp
    content: |
      #!/bin/bash
      mkdir -p /var/app/current
      mkdir -p /var/app/staging
      chown -R webapp:webapp /var/app/current
      chown -R webapp:webapp /var/app/staging

commands:
  01_node_get:
    command: |
      curl --silent --location https://rpm.nodesource.com/setup_18.x | bash -
      yum -y install nodejs

container_commands:
  01_copy_files:
    command: |
      cp -r ./* /var/app/staging/
      cd /var/app/staging
      npm install
  02_permissions:
    command: |
      chmod 755 /var/app/staging
      chown -R webapp:webapp /var/app/staging 